<editor:CustomWindow x:Class="CG.Test.Editor.Json.Dialogs.ReferenceDialog"
                     xmlns:editor="clr-namespace:CG.Test.Editor"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:local="clr-namespace:CG.Test.Editor.Json.Dialogs" xmlns:viewmodels="clr-namespace:CG.Test.Editor.ViewModels"
                     mc:Ignorable="d"
                     Title="ReferenceDialog" Height="600" Width="800" WindowStartupLocation="CenterScreen" Topmost="False" ShowInTaskbar="False">
    <editor:CustomWindow.DataContext>
        <viewmodels:ReferenceDialogViewModel/>
    </editor:CustomWindow.DataContext>
    <Window.Resources>
        <editor:IsNullConverter x:Key="IsNullConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="auto"/>
            </Grid.ColumnDefinitions>
            <CheckBox x:Name="_hasReferenceCheckBox" VerticalAlignment="Center" Grid.Row="0" Margin="5, 5, 2.5, 0" Content="Has Reference" IsChecked="{Binding HasReference}"/>

            <TextBox Grid.Column="1" Margin="2.5, 5, 2.5, 0" Text="{Binding SearchText}"/>

            <Button Grid.Column="2" Margin="2.5, 5, 5, 0" FontFamily="{StaticResource SymbolFont}" FontSize="20" Content="&#xE721;" Command="{Binding SearchCommand}"/>
        </Grid>
      
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="0.5*"/>
            </Grid.ColumnDefinitions>
            
            <GridSplitter Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Stretch" Width="3"/>
            <TreeView x:Name="_treeView" Grid.Column="0" Margin="5, 5, 5, 0" IsEnabled="{Binding HasReference}" ItemsSource="{Binding RootNodes}" SelectedItemChanged="TreeView_SelectedItemChanged">
                <TreeView.Resources>
                    <Style TargetType="{x:Type TreeViewItem}" BasedOn="{StaticResource {x:Type TreeViewItem}}">
                        <Setter Property="IsExpanded" Value="True"/>
                    </Style>
                    <HierarchicalDataTemplate DataType="{x:Type viewmodels:EditorNodeTreeNode}" ItemsSource="{Binding Children}">
                        <Grid>
                            <TextBlock Text="{Binding Name}"/>
                        </Grid>
                    </HierarchicalDataTemplate>
                </TreeView.Resources>
            </TreeView>

            
            <ListView Grid.Column="2" Visibility="{Binding ObjectViewVisibility}" ItemsSource="{Binding SelectedObject.Nodes}" Margin="0, 5, 5, 0">
                <ListView.View>
                    <GridView>
                        <GridView.Columns>
                            <GridViewColumn Header="Field Name" Width="auto" DisplayMemberBinding="{Binding Key}"  />
                            <GridViewColumn Header="Value"      Width="auto" DisplayMemberBinding="{Binding Value}"/>
                        </GridView.Columns>
                    </GridView>
                </ListView.View>
                
            </ListView>
        </Grid>
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button x:Name="_okButton"              Grid.Column="0" Margin="5, 5, 2.5, 5"   Padding="6" Content="OK"     IsDefault="True" IsEnabled="{Binding HasSelection}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" Command="{Binding OkCommand}"/>
            <Button x:Name="_cancelButton"          Grid.Column="1" Margin="2.5, 5, 2.5, 5" Padding="6" Content="Cancel" IsCancel="True"/>
            <Grid Grid.Column="2" Visibility="{Binding GoToRefLocationVisibility}">
                <Button x:Name="_goToRefLocationButton" Margin="2.5, 5, 5, 5"  Padding="6" Content="Go To Reference Location" IsEnabled="{Binding HasReference}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" Command="{Binding GoToRefLocationCommand}"/>
            </Grid>
        </Grid>
    </Grid>
</editor:CustomWindow>
